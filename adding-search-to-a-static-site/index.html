<!DOCTYPE html>
<html lang="en">
  <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />

    <title>grtnr.com</title>

    <meta charset="utf-8" />
    <link rel="stylesheet" href="../theme/css/poole.css"/>
    <link rel="stylesheet" href="../theme/css/syntax.css"/>
    <link rel="stylesheet" href="../theme/css/lanyon.css"/>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
    <link rel="stylesheet" href="../theme/css/styles.css"/>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H8M7YDCSD4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());

      gtag('config', 'G-H8M7YDCSD4');
    </script>





  </head>

  <body>
<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">
<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  
    <div class="sidebar-item">Stuff that keeps me busy, like family, coding, math, mountains and more.</div>

  <nav class="sidebar-nav">

  <a class="sidebar-nav-item" href="../">Home</a>

  <a class="sidebar-nav-item" href="/tags">Topics</a>
  <a class="sidebar-nav-item" href="/recipes">Recipes</a>
  <a class="sidebar-nav-item" href="/about">About</a>
  <a class="sidebar-nav-item" href="/impressum">Impressum</a>

  </nav>

  <div class="sidebar-item">
    <p class="tiny-note">
      <a class="muted" href="https://github.com/thomaswilley/pelicanyan">pelicanyan v0.1</a>
    </p>
  </div>
</div>
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="../" title="Home">grtnr.com</a>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="posts">
<div class="post">
    <h1 class="post-title">
      Adding Search to a static&nbsp;site
    </h1>
    <span class="post-date">December 19, 2015</span>

    <p>So now I have a static site that is generated by jBake. So far so good. But what’s a site without a search? Search is a must. So how do we add search functionality to a static site? Easy: We use the search giants Custom Search functionality ;)</p>
<p>These are the steps I took to get there:</p>
<h2>Create the Custom Search Engine</h2>
<p>Nothing easiere: Just go to the <a href="http://www.google.com/cse" rel="noopener noreferrer" target="_blank">Google <span class="caps">CSE</span> page</a> and create it. The process is self explanatory: You need a name for your search engine, you tell it what content should be made available. In my case this would be all from <a href="https://tillgartner.com" rel="noopener noreferrer" target="_blank">tillgartner.com</a> and that’s basically it. We will return at the end to this site in order to fine tune the look <span class="amp">&amp;</span> feel of the results.</p>
<p><img alt="Google CSE administration" src="Custom_Search_-_Basic.jpg"/></p>
<p>The one thing we need from here is the code in order to embed the search. You get this code by clicking the bitton “<strong>Get Code</strong>“.</p>
<h2>Add the search field</h2>
<p>Next we need a search box on our pages. I want a search box on the top right of every page on the entire website. So I add it to the freemarker template that creates the menu. </p>
<p>In my case the <code>menu.ftl</code> looks something like this:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="c">&lt;!--</span><span class="w"> </span><span class="nx">Fixed</span><span class="w"> </span><span class="nx">navbar</span><span class="w"> </span><span class="o">--&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="nx">nav</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"navbar navbar-default navbar-fixed-top"</span><span class="w"> </span><span class="nx">role</span><span class="o">=</span><span class="s2">"navigation"</span><span class="o">&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"container-fluid"</span><span class="o">&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"navbar-header"</span><span class="o">&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">button</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">"button"</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"navbar-toggle"</span><span class="w"> </span><span class="nx">data</span><span class="o">-</span><span class="nx">toggle</span><span class="o">=</span><span class="s2">"collapse"</span><span class="w"> </span><span class="nx">data</span><span class="o">-</span><span class="nx">target</span><span class="o">=</span><span class="s2">".navbar-collapse"</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">span</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"sr-only"</span><span class="o">&gt;</span><span class="nx">Toggle</span><span class="w"> </span><span class="nx">navigation</span><span class="o">&lt;</span><span class="err">/span&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">span</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"icon-bar"</span><span class="o">&gt;&lt;</span><span class="err">/span&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">span</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"icon-bar"</span><span class="o">&gt;&lt;</span><span class="err">/span&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">span</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"icon-bar"</span><span class="o">&gt;&lt;</span><span class="err">/span&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<span class="w">          </span><span class="o">&lt;</span><span class="nx">a</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"navbar-brand"</span><span class="w"> </span><span class="nx">href</span><span class="o">=</span><span class="s2">"/"</span><span class="o">&gt;</span><span class="nx">tillgartner</span><span class="p">.</span><span class="nx">com</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"navbar-collapse collapse"</span><span class="o">&gt;</span>
<span class="w">          </span><span class="o">&lt;</span><span class="nx">ul</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"nav navbar-nav"</span><span class="o">&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;&lt;</span><span class="nx">a</span><span class="w"> </span><span class="nx">href</span><span class="o">=</span><span class="s2">"/recipe/recipe.html"</span><span class="o">&gt;</span><span class="nx">Recipes</span><span class="o">&lt;</span><span class="err">/a&gt;&lt;/li&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;&lt;</span><span class="nx">a</span><span class="w"> </span><span class="nx">href</span><span class="o">=</span><span class="s2">"/about.html"</span><span class="o">&gt;</span><span class="nx">About</span><span class="o">&lt;</span><span class="err">/a&gt;&lt;/li&gt;</span>
<span class="w">          </span><span class="o">&lt;</span><span class="err">/ul&gt;</span>
<span class="w">          </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"col-sm-3 col-md-3 pull-right"</span><span class="o">&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">form</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"navbar-form"</span><span class="w"> </span><span class="nx">role</span><span class="o">=</span><span class="s2">"search"</span><span class="w"> </span><span class="nx">action</span><span class="o">=</span><span class="s2">"/search.html"</span><span class="o">&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"input-group"</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">"text"</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"form-control"</span><span class="w"> </span><span class="nx">placeholder</span><span class="o">=</span><span class="s2">"Search"</span><span class="w"> </span><span class="nx">name</span><span class="o">=</span><span class="s2">"q"</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"input-group-btn"</span><span class="o">&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">button</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"btn btn-default"</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">"submit"</span><span class="o">&gt;</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="nx">i</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"glyphicon glyphicon-search"</span><span class="o">&gt;&lt;</span><span class="err">/i&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
<span class="w">         </span><span class="o">&lt;</span><span class="err">/form&gt;</span>
<span class="w">         </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="sr">/div&gt;&lt;!--/</span><span class="p">.</span><span class="nx">nav</span><span class="o">-</span><span class="nx">collapse</span><span class="w"> </span><span class="o">--&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="err">/nav&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">"container"</span><span class="o">&gt;</span>
</code></pre></div>
<p><em>Note:</em> I fixed the code on my site and on the code above on 29.12.2015. The code for the button that appears when the width of the screen makes the menu collapse, was missing. Just in case you read this earlier and wonder why it’s different now…</p>
<p>I found thatthe part of the menu and how it collapses wasn’t trivial. The best explanation I found was <a href="https://bootstrapbay.com/blog/bootstrap-tutorial-navbar/" rel="noopener noreferrer" target="_blank">this video</a>.</p>
<p>It’s standard Bootstrap menu jiggling. What’s special in our case is the <code>action</code> attribute in the form that links to the search result page (called <code>search.html</code> in my case).</p>
<p>The result is a neat little serach box on the top right corner:</p>
<p><img alt="Search box" src="search_box.jpg"/></p>
<h2>Search result page</h2>
<p>Last but not least we need the search result page. This page will be called (i.e. linked to) from the search form we just made. It’s <span class="caps">URL</span> will be something like </p>
<div class="highlight"><pre><span></span><code>http://tillgartner.com/search.html?q=huhu
</code></pre></div>
<p>In my case the search result page will hold <strong>only</strong> the search result. In case the user wants to modify his search, he still has the ubiquitous search box on the top right corner.
The search result page will hold the code we copied when configuring the Custom Serach Engine. In my case the entire Markdown file looks like this:</p>
<div class="highlight"><pre><span></span><code><span class="nx">title</span><span class="o">=</span><span class="nx">Search</span>
<span class="nx">type</span><span class="o">=</span><span class="nx">page</span>
<span class="nx">date</span><span class="o">=</span><span class="mf">2015</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">17</span>
<span class="nx">status</span><span class="o">=</span><span class="nx">published</span>
<span class="o">~~~~~~</span>

<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="w">  </span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">cx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'XXX_Your_code:goes_here_XXX'</span><span class="p">;</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">gcse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'script'</span><span class="p">);</span>
<span class="w">    </span><span class="nx">gcse</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'text/javascript'</span><span class="p">;</span>
<span class="w">    </span><span class="nx">gcse</span><span class="p">.</span><span class="k">async</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="nx">gcse</span><span class="p">.</span><span class="nx">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'https:'</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">'https:'</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">'http:'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="s1">'//www.google.com/cse/cse.js?cx='</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">cx</span><span class="p">;</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'script'</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
<span class="w">    </span><span class="nx">s</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">gcse</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">);</span>
<span class="w">  </span><span class="p">})();</span>
<span class="o">&lt;</span><span class="err">/script&gt;</span>
<span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="nx">markdown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"0"</span><span class="o">&gt;&lt;</span><span class="nx">gcse</span><span class="o">:</span><span class="nx">searchresults</span><span class="o">-</span><span class="nx">only</span><span class="o">&gt;</span><span class="nx">Search</span><span class="w"> </span><span class="nx">results</span><span class="p">...</span><span class="o">&lt;</span><span class="err">/gcse:searchresults-only&gt;&lt;/div&gt;</span>
</code></pre></div>
<p>It took me a while to figure out how to tell markdown that this is pure <span class="caps">HTML</span> and that it should take it as such without transforming or quoting it. The solution was the <code>&lt;div markdown="0"&gt;</code> tag.</p>
<h2>Resources</h2>
<p>Some reading that helped me to find wy way:</p>
<ul>
<li><a href="http://www.google.com/cse" rel="noopener noreferrer" target="_blank">Create your own search engine</a></li>
<li><a href="http://www.cambiaresearch.com/articles/84/how-to-integrate-a-google-custom-search-popup-in-a-bootstrap-navbar" rel="noopener noreferrer" target="_blank">How to Integrate a Google Custom Search Popup In a Bootstrap Navbar</a></li>
<li><a href="https://developers.google.com/custom-search/docs/tutorial/implementingsearchbox" rel="noopener noreferrer" target="_blank">Implementing search box, by Google</a></li>
</ul>
      <div id="giscus">
        <script src="https://giscus.app/client.js" data-repo="tillg/grtnr.com_2024" data-repo-id="R_kgDONYRp_Q"
          data-category="Q&A" data-category-id="DIC_kwDONYRp_c4Cm0cH" data-mapping="pathname" data-strict="0"
          data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme"
          data-lang="en" crossorigin="anonymous" async>
      </script>
  </div>

  </div>
</div>
      </div>

      <label for="sidebar-checkbox" class="sidebar-toggle"></label>

      <script>
        (function(document) {
          var i = 0;
          // snip empty header rows since markdown can't
          var rows = document.querySelectorAll('tr');
          for(i=0; i<rows.length; i++) {
            var ths = rows[i].querySelectorAll('th');
            var rowlen = rows[i].children.length;
            if (ths.length > 0 && ths.length === rowlen) {
              rows[i].remove();
            }
          }
        })(document);
      </script>

      <script>
        /* Lanyon & Poole are Copyright (c) 2014 Mark Otto. Adapted to Pelican 20141223 and extended a bit by @thomaswilley */
        (function(document) {
          var toggle = document.querySelector('.sidebar-toggle');
          var sidebar = document.querySelector('#sidebar');
          var checkbox = document.querySelector('#sidebar-checkbox');
          document.addEventListener('click', function(e) {
            var target = e.target;
            if(!checkbox.checked ||
            sidebar.contains(target) ||
            (target === checkbox || target === toggle)) return;
            checkbox.checked = false;
            }, false);
            })(document);
      </script>
        <script src="/theme/js/giscus-comments.js"></script>

     </div>
  </body>
</html>